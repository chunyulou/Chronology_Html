<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­£è¦ºå¤§äº‹è¨˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #8B6F47 0%, #6B4423 100%);
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #8B6F47 0%, #6B4423 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        /* Tab æ¨£å¼ */
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
        }

        .tabs::-webkit-scrollbar {
            height: 6px;
        }

        .tabs::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .tabs::-webkit-scrollbar-thumb {
            background: #8B6F47;
            border-radius: 3px;
        }

        .tabs::-webkit-scrollbar-thumb:hover {
            background: #6B4423;
        }

        .tab {
            flex: 0 0 auto;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s;
            border: none;
            background: none;
            font-size: 14px;
            position: relative;
            min-width: 100px;
        }

        .tab:hover {
            background: rgba(139, 111, 71, 0.1);
            color: #8B6F47;
        }

        .tab.active {
            color: #8B6F47;
            background: white;
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #8B6F47;
        }

        /* æç¤ºå’Œç°¡ä»‹å€åŸŸ */
        .info-section {
            padding: 20px 30px;
            background: white;
        }

        .hint-text {
            text-align: center;
            color: #6c757d;
            font-size: 13px;
            margin-bottom: 15px;
        }

        .description {
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 8px;
            color: #495057;
            font-size: 14px;
            line-height: 1.6;
            border-left: 4px solid #8B6F47;
        }

        /* è¡¨æ ¼å®¹å™¨ */
        .table-container {
            max-height: 600px;
            overflow-y: auto;
            border-top: 1px solid #dee2e6;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f8f9fa;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 18px;
            text-align: left;
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        th:nth-child(1) {
            width: 10%;
        }

        th:nth-child(2) {
            width: 20%;
        }

        th:nth-child(3) {
            width: 70%;
        }

        /* æ’åºå’Œæœå°‹åœ–ç¤º */
        .sort-icon {
            display: inline-block;
            margin-left: 8px;
            cursor: pointer;
            font-size: 12px;
            color: #8B6F47;
            transition: transform 0.3s;
        }

        .sort-icon.desc {
            transform: rotate(180deg);
        }

        .search-icon {
            display: inline-block;
            margin-left: 8px;
            cursor: pointer;
            font-size: 14px;
            color: #8B6F47;
            transition: all 0.3s;
        }

        .search-icon:hover {
            color: #6B4423;
            transform: scale(1.1);
        }

        /* æœå°‹è¼¸å…¥æ¡† */
        .search-input-container {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            padding: 0;
        }

        .search-input-container.show {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
        }

        .search-input {
            flex: 1;
            padding: 10px 12px;
            border: 2px solid #8B6F47;
            border-radius: 6px;
            font-size: 14px;
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            transition: all 0.3s;
            background: #fff9e6;
            min-width: 0;
        }

        .search-input:focus {
            outline: none;
            border-color: #6B4423;
            box-shadow: 0 0 0 3px rgba(139, 111, 71, 0.1);
        }

        .search-input::placeholder {
            color: #999;
        }

        /* é—œé–‰æœå°‹æŒ‰éˆ• */
        .close-search-btn {
            flex-shrink: 0;
            width: 32px;
            height: 32px;
            border: none;
            background: #8B6F47;
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            padding: 0;
            line-height: 1;
        }

        .close-search-btn:hover {
            background: #6B4423;
            transform: scale(1.05);
        }

        /* äº‹ä»¶æ¬„ä½æ¨™é¡Œ */
        th.event-header {
            position: relative;
        }

        th.event-header.searching {
            padding: 0;
        }

        /* é«˜äº®é¡¯ç¤º */
        .highlight {
            background-color: #ffff00;
            padding: 2px 0;
            font-weight: 600;
        }

        tbody tr {
            transition: background-color 0.2s;
        }

        tbody tr:hover {
            background-color: #f8f9fa;
        }

        td {
            padding: 16px 18px;
            border-bottom: 1px solid #e9ecef;
            color: #495057;
            vertical-align: top;
        }

        td:nth-child(1) {
            font-weight: 600;
            color: #8B6F47;
        }

        /* å‚™è¨»åœ–ç¤º */
        .note-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: #8B6F47;
            color: white;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            margin-left: 8px;
            transition: all 0.3s;
        }

        .note-icon:hover {
            background: #6B4423;
            transform: scale(1.1);
        }

        /* æ¨¡æ…‹æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-dialog {
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal-content {
            background: white;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            max-height: 90vh;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            animation: slideUp 0.3s;
        }

        .modal-header {
            padding: 25px 30px;
            background: linear-gradient(135deg, #8B6F47 0%, #6B4423 100%);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 12px 12px 0 0;
            flex-shrink: 0;
        }

        .modal-header h2 {
            font-size: 20px;
            margin: 0;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 30px;
            overflow-y: auto;
            flex: 1;
        }

        .modal-info {
            margin-bottom: 20px;
        }

        .modal-info label {
            display: block;
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .modal-info p {
            color: #6c757d;
            line-height: 1.8;
            font-size: 15px;
            white-space: pre-wrap;
        }

        .modal-footer {
            padding: 20px 30px;
            border-top: 1px solid #dee2e6;
            display: flex;
            justify-content: flex-end;
            flex-shrink: 0;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* æ»¾å‹•æ¢æ¨£å¼ */
        .table-container::-webkit-scrollbar,
        .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        .table-container::-webkit-scrollbar-track,
        .modal-body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .table-container::-webkit-scrollbar-thumb,
        .modal-body::-webkit-scrollbar-thumb {
            background: #8B6F47;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover,
        .modal-body::-webkit-scrollbar-thumb:hover {
            background: #6B4423;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ•‰ï¸ æ­£è¦ºå¤§äº‹è¨˜</h1>
        </div>

        <!-- Tabs -->
        <div class="tabs" id="tabsContainer">
            <button class="tab active" data-category="ç¸½è¡¨">ç¸½è¡¨</button>
            <button class="tab" data-category="å¹³å¯¦å°å¸«">å¹³å¯¦å°å¸«</button>
            <button class="tab" data-category="è¬›ç¶“">è¬›ç¶“</button>
            <button class="tab" data-category="å‡ºç‰ˆå“">å‡ºç‰ˆå“</button>
            <button class="tab" data-category="é–‹èª²">é–‹èª²</button>
            <button class="tab" data-category="ç¦ªä¿®">ç¦ªä¿®</button>
            <button class="tab" data-category="è¦–é »å¼˜æ³•">è¦–é »å¼˜æ³•</button>
            <button class="tab" data-category="æ³•æœƒ">æ³•æœƒ</button>
            <button class="tab" data-category="å®£å°æ´»å‹•">å®£å°æ´»å‹•</button>
            <button class="tab" data-category="ç¥–å¸«å ‚èˆ‡æ­£è¦ºå¯º">ç¥–å¸«å ‚èˆ‡æ­£è¦ºå¯º</button>
        </div>

        <!-- æç¤ºå’Œç°¡ä»‹å€åŸŸ -->
        <div class="info-section">
            <div class="hint-text">
                ğŸ’¡ æç¤ºï¼šé»æ“Šå¤§äº‹æ—çš„ ğŸ“ åœ–ç¤ºå¯æŸ¥çœ‹è©³ç´°å‚™è¨»
            </div>
            <div class="description" id="categoryDescription">
                æ­£è¦ºæ•™åœ˜å¤§äº‹è¨˜ç¸½è¦½ï¼Œè¨˜éŒ„å¾1987å¹´è‡³ä»Šçš„é‡è¦å¼˜æ³•æ­·ç¨‹ã€‚
            </div>
        </div>

        <!-- è¡¨æ ¼ -->
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>åºè™Ÿ</th>
                        <th onclick="toggleSort()" style="cursor: pointer;">
                            æ—¥æœŸ
                            <span class="sort-icon" id="sortIcon">â–¼</span>
                        </th>
                        <th class="event-header" id="eventHeader">
                            <span id="eventHeaderText">
                                å¤§äº‹
                                <span class="search-icon" onclick="toggleSearch()" title="æœå°‹">ğŸ” æœå°‹</span>
                            </span>
                            <div class="search-input-container" id="searchContainer">
                                <input 
                                    type="text" 
                                    class="search-input" 
                                    id="searchInput" 
                                    placeholder="è¼¸å…¥é—œéµå­—æœå°‹..."
                                    oninput="handleSearch()"
                                >
                                <button class="close-search-btn" onclick="toggleSearch()" title="é—œé–‰æœå°‹">âœ•</button>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody id="eventTable">
                    <!-- è³‡æ–™å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- æ¨¡æ…‹æ¡† -->
    <div class="modal" id="noteModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ğŸ“ è©³ç´°å‚™è¨»</h2>
                    <button class="close-btn" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="modal-info">
                        <label>æ—¥æœŸ</label>
                        <p id="modalDate"></p>
                    </div>
                    <div class="modal-info">
                        <label>å¤§äº‹</label>
                        <p id="modalEvent"></p>
                    </div>
                    <div class="modal-info">
                        <label>ç´€è¦</label>
                        <p id="modalNote"></p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeModal()">é—œé–‰</button>
                </div>
            </div>
        </div>
    </div>

    <script src="table_data.js"></script>
    <script>
        // é¡åˆ¥ç°¡ä»‹
        const categoryDescriptions = {
            'ç¸½è¡¨': 'æ­£è¦ºæ•™åœ˜å¤§äº‹è¨˜ç¸½è¦½ï¼Œå…± 210 ç­†è³‡æ–™ï¼Œè¨˜éŒ„å¾1987å¹´è‡³ä»Šçš„é‡è¦å¼˜æ³•æ­·ç¨‹ã€‚',
            'å¹³å¯¦å°å¸«': 'å¹³å¯¦å°å¸«ç›¸é—œçš„é‡è¦äº‹è¹Ÿèˆ‡å¼˜æ³•æ´»å‹•ã€‚',
            'è¬›ç¶“': 'å¹³å¯¦å°å¸«æ­·å¹´è¬›ç¶“èªªæ³•çš„è¨˜éŒ„ã€‚',
            'å‡ºç‰ˆå“': 'æ­£è¦ºæ•™åœ˜å‡ºç‰ˆçš„å„é¡æ›¸ç±èˆ‡æ–‡ç« ã€‚',
            'é–‹èª²': 'å„é¡èª²ç¨‹é–‹è¨­èˆ‡æ•™å­¸æ´»å‹•ã€‚',
            'ç¦ªä¿®': 'ç¦ªä¸‰ã€ç¦ªä¸ƒç­‰ç¦ªä¿®æ´»å‹•è¨˜éŒ„ã€‚',
            'è¦–é »å¼˜æ³•': 'ç¶²è·¯è¦–é »èˆ‡å½±éŸ³å¼˜æ³•ç›¸é—œæ´»å‹•ã€‚',
            'æ³•æœƒ': 'å„é¡æ³•æœƒèˆ‡å…±ä¿®æ´»å‹•ã€‚',
            'å®£å°æ´»å‹•': 'å°å¤–å®£å°èˆ‡æ¨å»£æ´»å‹•ã€‚',
            'ç¥–å¸«å ‚èˆ‡æ­£è¦ºå¯º': 'ç¥–å¸«å ‚èˆ‡æ­£è¦ºå¯ºç›¸é—œäº‹é …ã€‚'
        };

        // åˆ†é¡é—œéµå­—
        const categoryKeywords = {
            'å¹³å¯¦å°å¸«': ['å°å¸«', 'å¹³å¯¦'],
            'è¬›ç¶“': ['è¬›ç¶“', 'é–‹è¬›', 'è¬›è¿°', 'å®£è¬›', 'é–‹ç¤º'],
            'å‡ºç‰ˆå“': ['å‡ºç‰ˆ', 'ç™¼è¡Œ', 'å°è¡Œ', 'æ›¸ç±', 'è‘—ä½œ'],
            'é–‹èª²': ['é–‹èª²', 'é–‹ç­', 'ç¦ªæ·¨ç­', 'é€²éšç­', 'å¢ä¸Šç­'],
            'ç¦ªä¿®': ['ç¦ªä¸‰', 'ç¦ªä¸ƒ', 'ç¦ªäºŒ', 'ç¦ªä¿®', 'æ‰“ç¦ª', 'ç¦ªäº”'],
            'è¦–é »å¼˜æ³•': ['è¦–é »', 'å½±ç‰‡', 'éŒ„è£½', 'YouTube', 'ç¶²è·¯', 'ç›´æ’­'],
            'æ³•æœƒ': ['æ³•æœƒ', 'ä½›ä¸ƒ', 'å…±ä¿®', 'è¶…è–¦', 'èª¦ç¶“', 'æµ´ä½›', 'å¤§æ‚²æ‡º'],
            'å®£å°æ´»å‹•': ['å®£å°', 'è¬›åº§', 'æ´»å‹•', 'åœ’éŠæœƒ', 'å±•è¦½'],
            'ç¥–å¸«å ‚èˆ‡æ­£è¦ºå¯º': ['ç¥–å¸«å ‚', 'æ­£è¦ºå¯º', 'å¯ºé™¢', 'ä½›å¯º']
        };

        // è³‡æ–™åˆ†é¡
        function categorizeData(data) {
            const categorized = {
                'ç¸½è¡¨': data, // ç¸½è¡¨é¡¯ç¤ºå…¨éƒ¨è³‡æ–™
                'å¹³å¯¦å°å¸«': [],
                'è¬›ç¶“': [],
                'å‡ºç‰ˆå“': [],
                'é–‹èª²': [],
                'ç¦ªä¿®': [],
                'è¦–é »å¼˜æ³•': [],
                'æ³•æœƒ': [],
                'å®£å°æ´»å‹•': [],
                'ç¥–å¸«å ‚èˆ‡æ­£è¦ºå¯º': []
            };

            data.forEach(item => {
                const text = item.column3 + ' ' + item.column4;
                
                for (const [category, keywords] of Object.entries(categoryKeywords)) {
                    for (const keyword of keywords) {
                        if (text.includes(keyword)) {
                            categorized[category].push(item);
                            break;
                        }
                    }
                }
            });

            return categorized;
        }

        // ç•¶å‰é¡¯ç¤ºçš„é¡åˆ¥
        let currentCategory = 'ç¸½è¡¨';
        let categorizedData = {};
        let sortOrder = 'asc'; // 'asc' æˆ– 'desc'
        let searchKeyword = '';

        // é«˜äº®é—œéµå­—å‡½æ•¸
        function highlightText(text, keyword) {
            if (!keyword || !text) return text;
            
            const regex = new RegExp(`(${keyword.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        // ç”Ÿæˆè¡¨æ ¼å…§å®¹çš„å‡½æ•¸
        function renderTable(category) {
            const tableBody = document.getElementById('eventTable');
            tableBody.innerHTML = '';
            
            let data = categorizedData[category] || [];
            
            // æœå°‹ç¯©é¸
            if (searchKeyword) {
                data = data.filter(item => {
                    const searchText = (item.column3 + ' ' + item.column4).toLowerCase();
                    return searchText.includes(searchKeyword.toLowerCase());
                });
            }
            
            // æ’åº - ä½¿ç”¨ id ä¾†ä¿æŒåŸå§‹é †åº
            const sortedData = [...data].sort((a, b) => {
                if (sortOrder === 'asc') {
                    return a.id - b.id; // å‡å†ªï¼šæŒ‰ç…§ Word æª”æ¡ˆåŸå§‹é †åºï¼ˆèˆŠåˆ°æ–°ï¼‰
                } else {
                    return b.id - a.id; // é™å†ªï¼šåè½‰é †åºï¼ˆæ–°åˆ°èˆŠï¼‰
                }
            });
            
            if (sortedData.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="3" style="text-align: center; padding: 40px; color: #6c757d;">æŸ¥ç„¡ç¬¦åˆçš„è³‡æ–™</td>';
                tableBody.appendChild(row);
                return;
            }

            sortedData.forEach((item, index) => {
                const row = document.createElement('tr');
                const hasNote = item.column4 && item.column4.trim() !== '';
                
                // é«˜äº®è™•ç†
                const highlightedEvent = highlightText(item.column3, searchKeyword);
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.column2}</td>
                    <td>
                        ${highlightedEvent}
                        ${hasNote ? `<span class="note-icon" onclick="openNoteModal(${item.id}, '${category}')" title="æŸ¥çœ‹å‚™è¨»">ğŸ“</span>` : ''}
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // ç§»é™¤ä¸éœ€è¦çš„æ—¥æœŸè§£æå‡½æ•¸
        // parseDateString å‡½æ•¸å·²ä¸å†éœ€è¦

        // åˆ‡æ›æ’åºé †åº
        function toggleSort() {
            sortOrder = sortOrder === 'asc' ? 'desc' : 'asc';
            const sortIcon = document.getElementById('sortIcon');
            
            if (sortOrder === 'desc') {
                sortIcon.classList.add('desc');
            } else {
                sortIcon.classList.remove('desc');
            }
            
            renderTable(currentCategory);
        }

        // åˆ‡æ›æœå°‹æ¡†é¡¯ç¤º
        function toggleSearch() {
            const searchContainer = document.getElementById('searchContainer');
            const searchInput = document.getElementById('searchInput');
            const eventHeaderText = document.getElementById('eventHeaderText');
            const eventHeader = document.getElementById('eventHeader');
            
            if (searchContainer.classList.contains('show')) {
                // é—œé–‰æœå°‹
                searchContainer.classList.remove('show');
                eventHeaderText.style.display = 'inline';
                eventHeader.classList.remove('searching');
                searchInput.value = '';
                searchKeyword = '';
                renderTable(currentCategory);
            } else {
                // é–‹å•Ÿæœå°‹
                searchContainer.classList.add('show');
                eventHeaderText.style.display = 'none';
                eventHeader.classList.add('searching');
                setTimeout(() => {
                    searchInput.focus();
                }, 100);
            }
        }

        // è™•ç†æœå°‹è¼¸å…¥
        function handleSearch() {
            const searchInput = document.getElementById('searchInput');
            searchKeyword = searchInput.value.trim();
            renderTable(currentCategory);
        }

        // æ›´æ–°ç°¡ä»‹æ–‡å­—
        function updateDescription(category) {
            document.getElementById('categoryDescription').textContent = categoryDescriptions[category];
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof tableData !== 'undefined') {
                categorizedData = categorizeData(tableData);
                renderTable(currentCategory);
            } else {
                console.error('è³‡æ–™æœªè¼‰å…¥');
            }
        });

        // Tab åˆ‡æ›åŠŸèƒ½
        const tabs = document.querySelectorAll('.tab');
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                currentCategory = this.getAttribute('data-category');
                
                // åˆ‡æ› tab æ™‚ä¿æŒç•¶å‰çš„æœå°‹å’Œæ’åºç‹€æ…‹
                renderTable(currentCategory);
                updateDescription(currentCategory);
            });
        });

        // é–‹å•Ÿå‚™è¨»æ¨¡æ…‹æ¡†
        function openNoteModal(id, category) {
            const allData = tableData;
            const item = allData.find(d => d.id === id);
            
            if (item) {
                document.getElementById('modalDate').textContent = item.column2;
                document.getElementById('modalEvent').innerHTML = highlightText(item.column3, searchKeyword);
                document.getElementById('modalNote').innerHTML = highlightText(item.column4, searchKeyword);
                document.getElementById('noteModal').classList.add('show');
            }
        }

        // é—œé–‰æ¨¡æ…‹æ¡†
        function closeModal() {
            document.getElementById('noteModal').classList.remove('show');
        }

        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰
        document.getElementById('noteModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // ESC éµé—œé–‰æ¨¡æ…‹æ¡†
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>
</html>
